- [상황에 따라 달라지는 this](#상황에-따라-달라지는-this)
  - [전역 공간에서의 this](#전역-공간에서의-this)
  - [메서드로서 호출할 때, 매서드 내부에서의 this](#메서드로서-호출할-때-매서드-내부에서의-this)
  - [함수로서 호출할 때, 함수 내부에서의 this](#함수로서-호출할-때-함수-내부에서의-this)
  - [콜백 함수 호출 시, 함수 내부에서의 this](#콜백-함수-호출-시-함수-내부에서의-this)
  - [생성자 함수 내부에서의 this](#생성자-함수-내부에서의-this)
- [명시적 this 바인딩](#명시적-this-바인딩)
  - [call 메서드](#call-메서드)
  - [apply 메서드](#apply-메서드)
  - [call, apply 활용](#call-apply-활용)
  - [bind 메서드](#bind-메서드)
  - [별도의 인자로 this를 받는 경우(콜백 함수 내에서의 this)](#별도의-인자로-this를-받는-경우콜백-함수-내에서의-this)

## 상황에 따라 달라지는 this

- this는 실행 컨택스트가 생성될 때 함께 결정
- 실행 컨택스트는 함수가 호출될 때 생성되므로, this는 함수가 호출를 호출할 때 결정
  <br> => **함수를 어떤 방식으로 호출하느냐에 따라 this 값이 달라진다.**

### 전역 공간에서의 this

- 전역공간에서의 this는 전역객체를 참조한다.
  - ex) 브라우저에서는 `window`, Nodejs에서는 `global`
- 전역변수를 선언하면 JS 엔진은 이를 전역객체의 프로퍼티로 할당한다.
- 전역변수로 선언한 경우 `delete` 연산자로 삭제가 되지 않는다.
  ```js
  var b = 2;
  delete b;
  console.log(b, window.b, this.b); // 2 2 2
  ```
  - 전역변수를 선언하면 JS 엔진이 전역겍체의 프로퍼티로 할당하면서, 해당 프로퍼티의 `configurable` 속성(변경 및 삭제 가능성)을 `false` 로 정의하기 때문이다.

### 메서드로서 호출할 때, 매서드 내부에서의 this

- 함수와 메서드는 미리 정의한 동작을 수행하는 코드 뭉치이다.
- 둘을 구분하는 차이는 `독립성`에 있는데, 함수는 그 자체로 독립적인 기능을 수행하는 반면, 메서드는 자신을 호출한 대상 객체에 관한 동작을 수행한다.
- 메서로드로서 호출할 경우 `this`는 메서드 호출 주체(메서드명 앞의 객체)를 참조한다.

### 함수로서 호출할 때, 함수 내부에서의 this

- 함수로서 호출한 경우 `this`는 전역객체를 참조한다. 이는 메서드의 내부함수에서도 동일하다.
- 메서의 내부함수에서 `this`를 우회하는 방법
  - 변수에 `this`를 할당하여 상위 스코프의 `this`를 저장하여 내부함수에서 활용
- ES6에서 화살표 함수는 this 바인딩 과정을 제외하여, 상위 스코프의 `this`를 그대로 활용할 수 있다.

### 콜백 함수 호출 시, 함수 내부에서의 this

- 콜백함수 : 함수 A의 제어권을 다른 함수 B에게 넘겨주는 경우, 함수 A를 콜백함수라 한다.
  - `this` 또한 함수 B 내부 로직에 따라 값이 결정된다.
- 제어권을 받은 함수에서 콜백 함수에 `this`가 될 대상을 지정한 경우, 그 대상을 참조하게 된다.
- 제어권을 받은 함수에서 콜백 함수에 `this`가 될 대상을 지정하지 않은 경우, 전역객체를 참조하게 된다.

### 생성자 함수 내부에서의 this

- 생성자 함수 : 공통된 성질을 지니는 객체들을 생성하는데 사용하는 함수
  - 생성자를 **클래스**, 클래스를 통해 만든 객체를 **인스턴스**라고 한다.
- new 명령어어와 함께 할수를 호출하면 해당 함수가 생성자로서 동작한다.
- 생성자 함수에서의 `this`는 생성될 인스턴스를 참조한다.

## 명시적 this 바인딩

### call 메서드

```js
function.prototype.call(thisArg[, arg1[, arg2[, ...]]])
```

- 메서드의 호출 주체인 함수를 즉시 실행하도록 하는 메서드
- 전달된 인자
  - 첫번째 인자 : `this` 바인딩할 대상
  - 이후의 인자 : 호출할 함수의 매개변수

### apply 메서드

```js
function.prototype.apply(thisArg[, argsArray])
```

- `call` 메서도와 기능적으로 동일
- 두번째 인자를 배열로 받아 그 배열의 요소들을 호출할 함수의 매개변수로 지정한다.

### call, apply 활용

- 유사 배열 객체인 경우 `call` 또는 `apply` 메서드를 통해 배열 메서드를 차용할 수 있다.

  - 문자열의 경우 `length` 프로퍼티가 읽기 전용이기 때문에, 원본에 변경을 가하는 메서드는 에러를 던지고,<br>대상이 배열이여야하는 `cooncat`과 같은 메서드는 올바른 결과값을 얻을 수 없다.

  - `slice` 메서드를 통해 유사배열 객체를 배열 형태로 복사할 수 있다.
    - ES6에서는 `Array.from`을 통해 유사배열객체 또는 순회 가능한 모든 종류의 데이터 타입을 배열로 전환할 수 있다.

- 생성자 내부에서 다른 생성자 호출
  - 생성자 내부에서 다른 생성자와 공통된 내용이 있을 경우, `call` 또는 `apply`를 통해 생성자를 호출하여 반복을 줄일 수 있다.
- 여러 인수를 받는 메서드에 하나의 배열로 인수들을 전달하고 싶을 때, `apply` 메서드를 사용할 수 있다.
  - ES6에서는 spread operator(`...`)를 사용하여 `apply`보다 간결하게 작성할 수 있다.

### bind 메서드

```js
function.prototype.bind(thisArg[, arg1[, arg2[, ...]]])
```

- 즉시 호출하지 않고 넘겨받은 `this` 및 인수들을 바탕으로 새로운 함수를 반환하는 메서드
- 새로운 함수가 호출할 때 넘겨진 인수들은, `bind` 메서드를 호출할 때 전달했던 인수들의 뒤에 등록된다.
- `name` 프로퍼티에 `bound`라는 접두어가 붇어, 원본 함수에 `bind`메서드를 적용한 새로운 함수라는 의미를 지닌다.<br> 이로 인해 코드 추적이 용이해진다.

### 별도의 인자로 this를 받는 경우(콜백 함수 내에서의 this)

- 콜배함수를 인자로 받는 메서드중 `this`로 지정할 객체(`thisArg`)를 인자로 정할 수 있는 경우가 있다. <br>ex) 배열메서드
- 이를 통해 콜백함수 내부에서 `this`값을 원하는 대로 변경할 수 있다.
